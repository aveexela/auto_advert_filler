## Постановка задачи

Цель проекта — автоматическое извлечение и последующее автозаполнение
структурированной информации из онлайн-объявлений
(HTML-страниц и изображений товаров)
в рамках мультимодального ML-пайплайна.

Проект направлен на формирование основы для автозаполнения карточек товаров
и включает этапы сбора данных, их структурирования и эксперименты
с мультимодальным анализом.

Задача включает:
- извлечение текстовых полей из HTML-страниц объявлений
  (название, категория, характеристики, описание);
- загрузку и базовую обработку изображений объявлений;
- формирование структурированного датасета;
- экспериментальную реализацию мультимодального пайплайна
  для классификации и анализа данных.

---

## Аудитория и применение

Проект ориентирован на сценарии автоматизации работы с маркетплейсами
и классифайдами объявлений, включая:
- генерацию черновиков карточек товаров;
- подготовку датасетов для обучения мультимодальных моделей;
- ускорение модерации и предварительной классификации контента.

---

## Текущий статус проекта

На текущий момент реализованы следующие компоненты проекта:

### 1. Парсинг и подготовка данных
- парсинг HTML-страниц объявлений;
- извлечение заголовка, категории, характеристик и описания;
- загрузка и сохранение изображений объявлений;
- формирование структурированных файлов данных в формате `jsonl`.

### 2. Экспериментальный мультимодальный пайплайн
- реализован отдельный Jupyter Notebook с экспериментами
  по мультимодальному анализу данных;
- используется предобученная модель CLIP для работы с изображениями и текстом;
- реализована базовая модель классификации;
- сохранены веса модели и вспомогательные артефакты
  (кодировщики меток).

Вся реализация представлена в виде Jupyter Notebook,
без выделения отдельных модулей в `.py`-файлы.

---

## Архитектура текущего решения

Проект организован в виде двух основных Jupyter Notebook:

- `01_parser.ipynb`:
  - чтение локальных HTML-файлов;
  - разбор DOM-структуры страницы;
  - извлечение текстовых и визуальных данных;
  - формирование структурированного представления объявления;
  - сохранение результатов в файловой системе.

- `02_pipeline.ipynb`:
  - загрузка подготовленного датасета;
  - извлечение эмбеддингов изображений и текста с использованием CLIP;
  - обучение и применение базовой модели классификации;
  - сохранение модели и связанных артефактов.

---

## Данные

В ходе работы был собран локальный датасет объявлений
с интернет-ресурса для размещения объявлений (Авито),
включающий HTML-страницы объявлений и изображения товаров.

HTML-страницы и изображения не опубликованы в репозитории
по причинам защиты прав правообладателя и большого объёма данных.

В репозитории доступны агрегированные результаты парсинга
в формате `jsonl`, содержащие:
- извлечённые структурированные поля объявлений;
- ссылки на оригинальные объявления;
- ссылки на изображения товаров.

---

## Структура репозитория
<pre>
│   README.md
│   requirements.txt
│
├───data
│   ├───datasets
│   │       dataset_dress.jsonl
│   │       ...
│   │       dataset_trousers_woman.jsonl
│   │
│   ├───model
│   │       classifier.pt
│   │       label_encoders.pkl 
│   │  
│   └───links
│           links_dress.txt
│           ...
│           links_trousers_woman.txt
│
└───notebooks
        01_parser.ipynb
        02_pipeline.ipynb  
</pre>

---

## Запуск
Установить зависимости:
```bash
pip install -r requirements.txt
```
Проект тестировался в окружении Python 3.11, версии библиотек зафиксированы в `requirements.txt`.
PyTorch устанавливается отдельно в зависимости от конфигурации CPU/CUDA.

---

## Время выполнения и ресурсы

Оценка времени выполнения парсинга для одного объявления:

- загрузка HTML-страницы: ~10 секунд;
- парсинг HTML и извлечение полей: ~10 секунд;
- загрузка изображений объявления: ~2 секунды.

Итого: ~22 секунды на одно объявление.

Замеры получены при локальном запуске,
без параллелизации и без кэширования,
в стандартном пользовательском окружении.

Ноутбук с ML-частью запускался с KAGGLE CPU
---
## Результаты экспериментов

В рамках экспериментальной части проекта были проведены базовые измерения
качества данных и работы мультимодального пайплайна.

### Статистика текстовых описаний

- средняя длина описания: 454.25 символа  
- минимальная длина описания: 57 символов  
- максимальная длина описания: 2371 символ  
- пустые описания: отсутствуют  

Данные показывают значительную вариативность длины пользовательских описаний.

---

### Метрики сходства текста и изображений

Для оценки согласованности текстовых описаний и изображений
использовались метрики ROUGE-L и CLIPScore.

**ROUGE-L (между исходными и обработанными описаниями):**
- среднее значение: 0.112  
- стандартное отклонение: 0.220  

**CLIPScore (между изображениями и текстами):**
- среднее значение: 0.204  
- стандартное отклонение: 0.026  

Оценка проводилась на подвыборке из 300 объявлений.

---

### Классификация атрибутов

Для нескольких категориальных атрибутов была обучена базовая модель
классификации на эмбеддингах CLIP.

Результаты после 8 эпох обучения:

| Атрибут    | Accuracy | Macro F1 |
|------------|----------|----------|
| category   | 0.728    | 0.673    |
| gender     | 0.806    | 0.795    |
| condition  | 0.711    | 0.299    |
| lot_type   | 0.897    | 0.315    |

Результаты отражают различия в сложности предсказания отдельных атрибутов
и используются в проекте в качестве базового ориентира.

---

## Ограничения текущей реализации

* парсер ориентирован на фиксированную структуру HTML-страниц;
* отсутствует полноценный автоматический сбор данных из сети;
* мультимодальная часть носит экспериментальный характер и не оптимизирована по качеству и производительности.
---

## План дальнейшей работы

* расширение и очистка датасета;
* формирование разметки для обучения моделей;
* развитие мультимодального автозаполнения полей по изображениям;
* оценка качества моделей и оптимизация пайплайна.


